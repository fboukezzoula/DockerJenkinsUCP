# Paramètres
$consulAddress = "http://localhost:8500"  # Remplacez par l'adresse de votre serveur Consul
$token = "votre_token_consul"            # Remplacez par votre propre token Consul
$key = "ma_clé"                          # La clé que vous voulez créer
$value = "ma_valeur"                     # La valeur associée à la clé

# Vérifier si la clé existe déjà
$existingKey = Invoke-RestMethod -Uri "$consulAddress/v1/kv/$key" -Headers @{ "X-Consul-Token" = $token }

if ($existingKey -eq $null) {
    # Créer la clé avec la valeur
    $data = @{ Value = [Text.Encoding]::UTF8.GetBytes($value) }
    Invoke-RestMethod -Uri "$consulAddress/v1/kv/$key" -Method Put -Headers @{ "X-Consul-Token" = $token } -Body (ConvertTo-Json $data)
    Write-Host "Clé créée avec succès."
} else {
    Write-Host "La clé existe déjà."
}
